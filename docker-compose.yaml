services:
  wordsworth:
    container_name: wordsworth
    image: python:latest
#    build:
#      context: .
#      dockerfile: infra/backend.Dockerfile
    restart: "no"
#    pull_policy: build
    volumes:
#      - ./data:/app/data
      - .:/app
    ports:
      - "5000:5000"
    working_dir: /app
    command: "/bin/sh -c 'pip install -U pip; pip install -r requirements.txt; python -u -m backend'"
    environment:
      - APP__LOG_LEVEL=INFO
      - APP__INPUT_FILENAME=./data/wordlist.json
      - APP__DATA_FILENAME=./data/puzzledata.json
      - APP__OUTPUT_FILENAME=./data/manuscript.pdf

      # Not currently used, but stand by
      - AI__MODEL=gemma3:12b
      - AI__HOST=http://localhost:11434/
  dorothy:
    container_name: dorothy
    image: node:lts-alpine
    restart: "no"
    volumes:
      - .:/app
    ports:
      - "5001:5001"
    working_dir: /app/frontend
    command: "/bin/sh -c 'npm install; npm run build; npm run serve'"